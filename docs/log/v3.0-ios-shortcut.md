# v3.0 — iOS Shortcut Fix (1.1b) — Implementation Log

**Status:** ✅ DONE — VERIFIED WORKING

## Why
iPhone users need background save from the Share Sheet without opening the app. The iOS Shortcut broke when v3.0 removed the raw anon key approach.

## Approach
- Same edge function as 1.1a, but uses **query parameters** instead of JSON body
- iOS Shortcuts JSON body builder is unreliable — query param approach is more robust
- Token baked into base URL: `...save-bookmark?token=TOKEN&url=`
- Shortcut uses 2 actions: Text (base URL + Shortcut Input variable) → Get Contents of URL (GET)
- Edge function accepts both GET and POST, `extractFields()` checks query params first

## Bugs Fixed
1. iOS Shortcuts JSON body builder unreliable — switched to query parameter approach
2. Edge function rejected GET requests (iOS Shortcuts default) — added GET support
3. Instructions only visible during token generation — made always-visible with 8 detailed steps

## Key Learnings
- **iOS Shortcuts JSON body is unreliable**: use query parameters instead — bake token into URL, append shared URL via Combine Text
- **Edge function must accept GET**: iOS Shortcuts default to GET with "Get Contents of URL"
- **Always test on real device**: curl tests are not sufficient for mobile features
